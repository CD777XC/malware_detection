# Importing libraries
from sklearn.pipeline import make_pipeline
from sklearn.model_selection import train_test_split
from sklearn.metrics import precision_score
from sklearn.ensemble import RandomForestClassifier
from xgboost import XGBClassifier

import time

from preproc import preproc_pipe, X, y
from features_select import start

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.3, random_state=42)

model = XGBClassifier()

pipe = make_pipeline(
    preproc_pipe,
    model
)

pipe.fit(X_train, y_train)

y_pred = pipe.predict(X_test)
precision = precision_score(y_true=y_test, y_pred=y_pred)

end = time.time()

print(f'Score: {pipe.score(X_test, y_test):.2f}')
print(f'Precision: {precision:.2f}')
print('---- %s seconds ----' %(end - start))
